<!DOCTYPE html>
<html>
<head>
    <title>Manage Booking</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

</head>
<body>
<div class="corner-logo">
  <a href="{{ url_for('landing_page') }}">
    <img src="{{ url_for('static', filename='flytau_logo_circle.png') }}" alt="FLYTAU">
  </a>
</div>
<h1>Manage Your Booking</h1>

{% if role == 'client' %}
<form method="GET" action="{{ url_for('manage_booking_result') }}">
    <input type="hidden" name="method" value="registered">
    <input type="hidden" name="email" value="{{ request.args.get('email') }}">
    <label for="status">Filter by Status:</label>
    <select name="status" id="status">
        <option value="">All</option>
        <option value="ACTIVE" {% if status_filter == 'ACTIVE' %}selected{% endif %}>Active</option>
        <option value="COMPLETED" {% if status_filter == 'COMPLETED' %}selected{% endif %}>Completed</option>
        <option value="CUSTOMER_CANCELLED" {% if status_filter == 'CUSTOMER_CANCELLED' %}selected{% endif %}>Customer Cancelled</option>
        <option value="SYSTEM_CANCELLED" {% if status_filter == 'SYSTEM_CANCELLED' %}selected{% endif %}>System Cancelled</option>
    </select>
    <button type="submit">Filter</button>
</form>
{% endif %}

{% for b in bookings %}
  <h3>Booking #{{ b.Booking_number }} ({{ b.Booking_status }})</h3>
  <p>Flight: {{ b.Flight_number }}</p>
  {% if b.flight_info %}
    <p>Flight Details: {{ b.flight_info.Departure_date }} at {{ b.flight_info.Departure_time }}
      from {{ b.flight_info.Origin_airport }} to {{ b.flight_info.Destination_airport }}</p>
  {% else %}
    <p>Flight Details: N/A</p>
  {% endif %}  
    {% for s in b.seats %}
     <p>Seats:
      {{ s.Row_num }}{{ s.Col_num }}
    </p>
  <p>Price: {{ b.price }}</p>
  <p>Refund: {{ b.refund }} </p>
    {% endfor %}
    <br>


  {% if b.Booking_status == 'ACTIVE' %}
    <form method="POST" action="{{ url_for('cancel_booking', booking_number=b.Booking_number) }}">
      <button type="submit">Cancel Booking</button>
      <p class="note">Note: Canceling a booking will result in a 5% canceling fee. No flight cancellation is allowed 36 hours prior to departure.</p>
    </form>
  {% endif %}
{% endfor %}

<form method="GET" action="{{ url_for('landing_page') }}">
  <button type="submit">Back to Home Page</button>  
</form>
</body>
</html>
