<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Flight {{ flight.Flight_number }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

</head>
<body>
<div class="corner-logo">
  <a href="{{ url_for('landing_page') }}">
    <img src="{{ url_for('static', filename='flytau_logo_circle.png') }}" alt="FLYTAU">
  </a>
</div>

<h1>Edit Flight {{ flight.Flight_number }}</h1>

{% if error %}
  <div class="error-box">{{ error }}</div>
{% endif %}

<!-- FLIGHT DETAILS -->
<h2>Flight details</h2>
<form method="POST" class="edit-flight-form">
    <input type="hidden" name="action" value="update_flight">

    <label>Origin</label>
    <select name="route" required>
        {% for r in routes %}
            <option value="{{ r.Route_id }}"
              {% if r.Route_id == flight.Route_id %}selected{% endif %}>
              {{ r.Origin_airport }} â†’ {{ r.Destination_airport }}
            </option>
        {% endfor %}
    </select>

    <label>Departure date</label>
    <input type="date" required name="departure_date" value="{{ flight.Departure_date }}">

    <label>Departure time</label>
    <input type="time" required name="departure_time" value="{{ flight.Departure_time }}">
    <label>Plane ID</label>
    <select name="plane_id" required>
        {% for p in planes %}
            <option value="{{ p.Plane_id }}"
              {% if p.Plane_id == flight.Plane_id %}selected{% endif %}>
              {{ p.Plane_id }}
            </option>
        {% endfor %}
    </select>
    {% if can_edit_economy %}
        <label for="economy_price">Economy Price:</label>
        <input type="number" id="economy_price" name="economy_price" step="0.01" value="{{ flight.economy_price or '' }}" required>
    {% else %}
        <div class="error-box">Economy price cannot be changed.</div>
    {% endif %}

    {% if can_edit_business %}
        <label for="business_price">Business Price:</label>
        <input type="number" id="business_price" name="business_price" step="0.01" value="{{ flight.business_price or '' }}">
    {% else %}
        <div class="error-box">Business price cannot be changed.</div>
    {% endif %}
    <label>Status</label>
    <select name="status" required>
        {% for s in ['ACTIVE', 'CANCELLED', 'FULLY BOOKED'] %}
            <option value="{{ s }}"
              {% if s == flight.Flight_status %}selected{% endif %}>
              {{ s }}
            </option>
        {% endfor %}
    </select>

    <button type="submit">Save flight details</button>
</form>

<hr>

<!-- CREW -->
<h2>Crew assignment</h2>
<form class="crew-form" method="POST">
    <input type="hidden" name="action" value="update_crew">

   <!-- pilots -->
<div class="crew-section-title">Pilots</div>
{% for pilot in pilots %}
  <label class="crew-item">
    <input type="checkbox" name="pilots"
           value="{{ pilot.Employee_id }}"
           {% if pilot.Employee_id in assigned_pilots %}checked{% endif %}>
    <span class="crew-name">{{ pilot.Hebrew_first_name }} {{ pilot.Hebrew_last_name }}</span>
  </label>
{% endfor %}

<!-- stewards -->
<div class="crew-section-title">Stewards</div>
{% for steward in stewards %}
  <label class="crew-item">
    <input type="checkbox" name="stewards"
           value="{{ steward.Employee_id }}"
           {% if steward.Employee_id in assigned_stewards %}checked{% endif %}>
    <span class="crew-name">{{ steward.Hebrew_first_name }} {{ steward.Hebrew_last_name }}</span>
  </label>
{% endfor %}


    <button type="submit">Save crew</button>
</form>
<form method="GET" action="{{ url_for('admin_dashboard') }}">
  <button type="submit">Back to Admin</button>  
</form>
</body>
</html>
