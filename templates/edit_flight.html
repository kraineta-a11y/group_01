<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Flight {{ flight.Flight_number }}</title>
</head>
<body>

<h1>Edit Flight {{ flight.Flight_number }}</h1>

{% if error %}
  <div class="error-box">{{ error }}</div>
{% endif %}

<!-- FLIGHT DETAILS -->
<h2>Flight details</h2>
<form method="POST">
    <input type="hidden" name="action" value="update_flight">

    <label>Origin</label>
    <select name="origin" required>
        {% for r in routes %}
            <option value="{{ r.Route_id }}"
              {% if r.Route_id == flight.Route_id %}selected{% endif %}>
              {{ r.Origin_airport }} â†’ {{ r.Destination_airport }}
            </option>
        {% endfor %}
    </select>

    <label>Departure date</label>
    <input type="date" required name="departure_date" value="{{ flight.Departure_date }}">

    <label>Departure time</label>
    <input type="time" required name="departure_time" value="{{ flight.Departure_time }}">
    <label>Plane ID</label>
    <select name="plane_id" required>
        {% for p in planes %}
            <option value="{{ p.Plane_id }}"
              {% if p.Plane_id == flight.Plane_id %}selected{% endif %}>
              {{ p.Plane_id }}
            </option>
        {% endfor %}
    </select>
    <label>Status</label>
    <select name="status">
        {% for s in ['ACTIVE', 'CANCELLED', 'DELAYED'] %}
            <option value="{{ s }}"
              {% if s == flight.Flight_status %}selected{% endif %}>
              {{ s }}
            </option>
        {% endfor %}
    </select>

    <button type="submit">Save flight details</button>
</form>

<hr>

<!-- CREW -->
<h2>Crew assignment</h2>
<form method="POST">
    <input type="hidden" name="action" value="update_crew">

    <!-- pilots -->
     <strong>Pilots:</strong><br>
    {% for pilot in pilots %}
        <label>
            <input type="checkbox" name="pilots"
                   value="{{ pilot.Employee_id }}"
                   {% if pilot.Employee_id in assigned_pilots %}checked{% endif %}>
            {{ pilot.Hebrew_first_name }} {{ pilot.Hebrew_last_name }}
        </label><br>
    {% endfor %}

    <!-- stewards -->
    <strong>Stewards:</strong><br>
    {% for steward in stewards %}
        <label>
            <input type="checkbox" name="stewards"
                   value="{{ steward.Employee_id }}"
                   {% if steward.Employee_id in assigned_stewards %}checked{% endif %}>
            {{ steward.Hebrew_first_name }} {{ steward.Hebrew_last_name }}
        </label><br>
    {% endfor %}

    <button type="submit">Save crew</button>
</form>
</body>
</html>
